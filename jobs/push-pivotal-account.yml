---
name: push-pivotal-account
release: pivotal-account
consumes: (( .properties.system_database.selected_option.parsed_manifest(mysql_db_link) ))
manifest: |
  cf:
    domain: (( .cloud_controller.system_domain.value ))
    admin_username: (( .uaa.admin_credentials.identity ))
    admin_password: (( .uaa.admin_credentials.password ))
  generic_white_label_config_json:
    company_name: (( .properties.push_apps_manager_company_name.value || "Pivotal" ))
    logo: (( .properties.push_apps_manager_logo.value ))
    smallSquare: (( .properties.push_apps_manager_square_logo.value ))
    legalText: (( .properties.push_apps_manager_footer_text.value ))
    legalLinks: (( .properties.push_apps_manager_footer_links.value ))
  pivotal_account:
    db: (( .properties.system_database.selected_option.parsed_manifest(pivotal_account) ))
    buildpack: java_buildpack_offline
    route: account
    client_id: (( .uaa.pivotal_account_client_credentials.identity ))
    client_secret: (( .uaa.pivotal_account_client_credentials.password ))
    uaa_location: https://login.(( .cloud_controller.system_domain.value ))
    notifications_location: https://notifications.(( .cloud_controller.system_domain.value ))
    notifications_ui_location: https://notifications-ui.(( .cloud_controller.system_domain.value ))
    encryption_key: (( encryption_key.value ))
    app_push:
      instance_number: 2
      memory: 1024
  ssl:
    skip_cert_verify: (( .ha_proxy.skip_cert_verify.value ))
