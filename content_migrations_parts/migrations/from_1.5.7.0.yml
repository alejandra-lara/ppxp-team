from_version: 1.5.7.0
rules:
  - type: update
    selector: "product_version"
    to: "1.6.4.0$PRERELEASE_VERSION$"
  - type: move
    selector: ""
    from: "jobs.[identifier=dea].properties.[identifier=allow_host_access]"
    to: "properties"
  - type: modify
    selector: properties.[identifier=allow_host_access].identifier
    from: allow_host_access
    to: allow_cross_container_traffic
  - type: append
    selector: "jobs.[identifier=cloud_controller].properties"
    to:
      identifier: default_to_diego_backend
      value: false
  - type: append
    selector: "properties.[identifier=system_blobstore].options.[identifier=external].properties"
    to:
      identifier: buildpacks_bucket
  - type: append
    selector: "properties.[identifier=system_blobstore].options.[identifier=external].properties"
    to:
      identifier: droplets_bucket
  - type: append
    selector: "properties.[identifier=system_blobstore].options.[identifier=external].properties"
    to:
      identifier: packages_bucket
  - type: append
    selector: "properties.[identifier=system_blobstore].options.[identifier=external].properties"
    to:
      identifier: resources_bucket
  - type: copy
    selector: ""
    from: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=bucket].value"
    to: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=buildpacks_bucket].value"
  - type: copy
    selector: ""
    from: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=bucket].value"
    to: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=droplets_bucket].value"
  - type: copy
    selector: ""
    from: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=bucket].value"
    to: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=packages_bucket].value"
  - type: copy
    selector: ""
    from: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=bucket].value"
    to: "properties.[identifier=system_blobstore].options.[identifier=external].properties.[identifier=resources_bucket].value"
  - type: delete
    selector: "properties.[identifier=system_blobstore].options.[identifier=external].properties"
    object: "[identifier=bucket]"
