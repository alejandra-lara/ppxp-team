---
name: loggr-system-metric-scraper
release: system-metrics-scraper
manifest: |
  enabled: (( $director.system_metrics_runtime_enabled ))
  scrape_interval: $( variable "system_metrics_scraper_scrape_interval" )
  scrape_port: 53035
  debug_port: $( variable "system_metrics_scraper_health_port" )
  system_metrics:
    tls:
      ca_cert: "(( $ops_manager.ca_certificate ))"
      cert: "((.properties.system_metrics_tls_scraper_cert.cert_pem))"
      key: "((.properties.system_metrics_tls_scraper_cert.private_key_pem))"
  metrics:
    port: $( variable "system_metrics_scraper_health_port" )
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.loggr_metric_scraper_metrics_tls.cert_pem ))
    key: (( .properties.loggr_metric_scraper_metrics_tls.private_key_pem ))
    server_name: loggr_metric_scraper_metrics
  leadership_election:
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.leadership_election_tls.cert_pem ))
    key: (( .properties.leadership_election_tls.private_key_pem ))
  nats_client:
    cert: (( .properties.nats_client_cert.cert_pem ))
    key: (( .properties.nats_client_cert.private_key_pem ))
