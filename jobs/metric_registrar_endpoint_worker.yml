---
name: metric_registrar_endpoint_worker
release: metric-registrar
manifest: |
  disabled: "(( .properties.metric_registrar_enabled.value ? false : true ))"
  health_check_port: 21542
  orchestration_port: 21543
  skip_ssl_validation: (( .ha_proxy.skip_cert_verify.value ))
  blacklisted_tags: (( .properties.metric_registrar_blacklisted_tags.parsed_strings ))
  scrape_interval: (( .properties.metric_registrar_scrape_interval_in_seconds.value ))s
  loggregator:
    tls:
      ca_cert: (( $ops_manager.ca_certificate ))
      agent:
        cert: (( .doppler.metron_tls_cert.cert_pem ))
        key: (( .doppler.metron_tls_cert.private_key_pem ))
  cloud_controller:
    tls:
      ca: (( $ops_manager.ca_certificate ))
      cert: (( .properties.cloud_controller_mutual_cert.cert_pem ))
      key: (( .properties.cloud_controller_mutual_cert.private_key_pem ))
  orchestration:
    tls:
      ca: (( $ops_manager.ca_certificate ))
      cert: (( .properties.metric_registrar_worker_tls.cert_pem ))
      key: (( .properties.metric_registrar_worker_tls.private_key_pem ))
  uaa:
    client:
      id: (( .uaa.metric_registrar_credentials.identity ))
      secret: (( .uaa.metric_registrar_credentials.password ))
