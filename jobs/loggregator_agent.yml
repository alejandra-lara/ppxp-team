---
name: loggregator_agent
release: loggregator-agent
manifest: |

  logging:
    format:
      timestamp: (( .properties.logging_timestamp_format.selected_option.parsed_manifest(rfc3339_or_deprecated) ))
  loggregator:
    tls:
      ca_cert: (( $ops_manager.ca_certificate ))
      agent:
        cert: (( .doppler.metron_tls_cert.cert_pem ))
        key: (( .doppler.metron_tls_cert.private_key_pem ))
  metrics:
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.loggregator_agent_metrics_tls.cert_pem ))
    key: (( .properties.loggregator_agent_metrics_tls.private_key_pem ))
    server_name: loggregator_agent_metrics
  grpc_port: 3459
  disable_udp: true
  disable_logs: (( .properties.disable_logs_in_firehose.value ))
  loggregator_agent:
    enabled: (( .properties.enable_v2_firehose.value ))
  tags:
    product: $( variable "label" )
    system_domain: "(( .cloud_controller.system_domain.value ))"
