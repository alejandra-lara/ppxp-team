---
name: isolated_router
label: Router
resource_label: Router
description: Routers route Internet traffic to applications placed in the isolation segment.
templates:
  - consul_agent
  - gorouter
  - metron_agent
  - syslog_forwarder

resource_definitions:
  - name: ram
    type: integer
    label: RAM
    configurable: true
    default: 1_024
    constraints:
      min: 1_024

  - name: ephemeral_disk
    type: integer
    label: Ephemeral Disk
    configurable: true
    default: 2_048
    constraints:
      min: 2_048

  - name: persistent_disk
    type: integer
    label: Persistent Disk
    configurable: false
    default: 0

  - name: cpu
    type: integer
    label: CPU
    configurable: true
    default: 1
    constraints:
      min: 1
      power_of_two: true

static_ip: 1
dynamic_ip: 0
max_in_flight: 1
single_az_only: false
serial: true

instance_definition:
  name: instances
  type: integer
  label: Instances
  configurable: true
  default: 3
  constraints:
    min: 0

property_blueprints:
  - name: static_ips
    type: ip_ranges
    configurable: true
    optional: true

  - name: disable_insecure_cookies
    type: boolean
    configurable: true
    default: false

  - name: status_credentials
    type: simple_credentials
    default:
      identity: router_status

  - name: enable_zipkin
    type: boolean
    configurable: true
    default: true

  - name: enable_write_access_logs
    type: boolean
    configurable: true
    default: true

  - name: request_timeout_in_seconds
    type: integer
    configurable: true
    default: 900
    constraints:
      min: 1

  - name: max_idle_connections
    type: integer
    configurable: true
    default: 0
    constraints:
      min: 0
      max: 50_000

  - name: extra_headers_to_log
    type: string_list
    configurable: true
    optional: true

  - name: drain_wait
    type: integer
    configurable: true
    default: 20

  - name: lb_healthy_threshold
    type: integer
    configurable: true
    default: 20
