---
name: windows_diego_cell
label: Windows Diego Cell
resource_label: Windows Diego Cell
templates:
  - $( job "consul_agent_windows" )
  - $( job "rep_windows" )
  - $( job "route_emitter_windows" )
  - $( job "event_log_forwarder" )
  - $( job "garden-windows" )
  - $( job "winc" )
  - $( job "groot" )
  - $( job "winc-network" )
  - $( job "metron_agent_windows" )
  - $( job "enable_rdp" )
  - $( job "enable_ssh" )
  - $( job "set_kms_host" )
  - $( job "set_password" )
  - $( job "windows2016fs" )
  - $( job "install-hwc-buildpack" )

resource_definitions:
  - name: ram
    type: integer
    label: RAM
    configurable: true
    default: 16_384
    constraints:
      min: 2_048

  # GCP currently sets the root disk size based on the size of the ephemeral
  # disk and the current recommended root disk size on GCP is 100GB
  # https://docs.pivotal.io/pivotalcf/2-1/windows/about-windows-stemcells.html
  - name: ephemeral_disk
    type: integer
    label: Ephemeral Disk
    configurable: true
    default: 102_400
    constraints:
      min: 102_400

  - name: persistent_disk
    type: integer
    label: Persistent Disk
    configurable: false
    default: 0

  - name: cpu
    type: integer
    label: CPU
    configurable: true
    default: 2
    constraints:
      min: 1
      power_of_two: true

static_ip: 0
dynamic_ip: 1
max_in_flight: "4%"
single_az_only: false

instance_definition:
  name: instances
  type: integer
  label: Instances
  configurable: true
  default: 3
  constraints:
    min: 1

property_blueprints:

# We pass placement tags as a list to CF but don't explain the option to configure multiple tags in the UI
  - name: placement_tags
    type: string_list
    configurable: true
    optional: true

  - name: windows_consul_agent_cert
    type: rsa_cert_credentials
    configurable: false
    default:
      domains:
      - 127.0.0.1
