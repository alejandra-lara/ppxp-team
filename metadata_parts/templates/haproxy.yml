---
name: haproxy
release: haproxy
manifest: |
  ha_proxy:
    backend_ca_file: (( .properties.haproxy_backend_ca.value ))
    backend_port: "(( .properties.haproxy_forward_tls.value ? .properties.haproxy_backend_port_https.value : .properties.haproxy_backend_port_http.value ))"
    backend_ssl: "(( .properties.haproxy_forward_tls.value ? 'verify' : 'off' ))"
    buffer_size_bytes: (( .properties.haproxy_max_buffer_size.value ))
    client_timeout: (( .router.request_timeout_in_seconds.value ))
    disable_http: (( .properties.routing_disable_http.value ))
    enable_health_check_http: true
    internal_only_domains: (( .ha_proxy.internal_only_domains.parsed_strings ))
    server_timeout: (( .router.request_timeout_in_seconds.value ))
    ssl_ciphers: (( .properties.ssl_ciphers.value ))
    ssl_pem: (( .properties.networking_poe_ssl_cert.cert_and_private_key_pems ))
    tcp_link_port: 2222
    trusted_domain_cidrs: (( .ha_proxy.trusted_domain_cidrs.value ))
