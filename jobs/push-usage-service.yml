---
name: push-usage-service
release: push-usage-service-release
consumes: |
  (( .properties.system_database.selected_option.parsed_manifest(push_app_usage_service_db_link) ))
manifest: |
  cf:
    api_url: "https://api.(( .cloud_controller.system_domain.value ))"
    uaa_url: "https://login.(( .cloud_controller.system_domain.value ))"
    notifications_service_url: "https://notifications.(( .cloud_controller.system_domain.value ))"
    admin_username: (( .uaa.push_apps_manager_credentials.identity ))
    admin_password: (( .uaa.push_apps_manager_credentials.password ))
    system_domain: (( .cloud_controller.system_domain.value ))
    apps_domain: (( .cloud_controller.apps_domain.value ))
  app_usage_service:
    url: "https://app-usage.(( .cloud_controller.system_domain.value ))"
    uaa_client_id: (( .uaa.usage_service_client_credentials.identity ))
    uaa_client_secret: (( .uaa.usage_service_client_credentials.password ))
    rails_secret_token: ((( push-usage-service-secret-token )))
  databases:
    app_usage_service: (( .properties.system_database.selected_option.parsed_manifest(push-app-usage-service) ))
  ssl:
    skip_cert_verify: (( .ha_proxy.skip_cert_verify.value ))
    disable_http_for_links: (( .properties.routing_disable_http.value ))
