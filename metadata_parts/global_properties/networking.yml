---
property_blueprints:
  - name: networking_point_of_entry
    type: selector
    configurable: true
    default: terminate_at_router
    option_templates:
      - name: terminate_at_router
        select_value: terminate_at_router
        property_blueprints:
          - name: ssl_rsa_certificate
            type: rsa_cert_credentials
            configurable: true
          - name: ssl_ciphers
            type: text
            configurable: true
            optional: true
        named_manifests:
          - name: ssl_ciphers
            manifest: (( .properties.networking_point_of_entry.terminate_at_router.ssl_ciphers.value ))
          - name: enable_ssl
            manifest: "true"
          - name: cert_pem
            manifest: (( .properties.networking_point_of_entry.terminate_at_router.ssl_rsa_certificate.cert_pem ))
          - name: private_key_pem
            manifest: (( .properties.networking_point_of_entry.terminate_at_router.ssl_rsa_certificate.private_key_pem ))
      - name: terminate_at_router_ert_cert
        select_value: terminate_at_router_ert_cert
        named_manifests:
          - name: ssl_ciphers
            manifest: (( ..cf.properties.networking_point_of_entry.external_ssl.ssl_ciphers.value ))
          - name: enable_ssl
            manifest: "true"
          - name: cert_pem
            manifest: (( ..cf.properties.networking_poe_ssl_cert.cert_pem ))
          - name: private_key_pem
            manifest: (( ..cf.properties.networking_poe_ssl_cert.private_key_pem ))
      - name: terminate_before_router
        select_value: terminate_before_router
        named_manifests:
          - name: enable_ssl
            manifest: "false"
          - name: ssl_ciphers
            manifest: ""
          - name: cert_pem
            manifest: ""
          - name: private_key_pem
            manifest: ""
  - name: container_networking
    type: selector
    configurable: true
    default: enable
    option_templates:
      - name: enable
        select_value: enable
        named_manifests:
          - name: cf_networking_disabled
            manifest: |
              false
          - name: garden_network_plugin
            manifest: |
              "/var/vcap/packages/runc-cni/bin/garden-external-networker"
          - name: garden_network_plugin_extra_args
            manifest: |
              - "--configFile=/var/vcap/jobs/garden-cni/config/adapter.json"
        property_blueprints:
          - name: vtep_port
            type: integer
            configurable: true
            default: 4789
      - name: disable
        select_value: disable
        named_manifests:
          - name: cf_networking_disabled
            manifest: |
              true
          - name: garden_network_plugin
          - name: garden_network_plugin_extra_args
            manifest: |
              []
        property_blueprints:
          - name: garden_network_pool
            type: string
            configurable: true
            default: 10.254.0.0/22
  - name: routing_table_sharding_mode
    type: selector
    configurable: true
    default: isolation_segment_only
    option_templates:
    - name: isolation_segment_only
      select_value: isolation_segment_only
      named_manifests:
      - name: sharding_mode
        manifest: |
          segments
      - name: isolation_segments
        manifest: |
          ['(( .isolated_diego_cell.placement_tag.value ))']
      - name: routing_api_enabled
        manifest: false
    - name: no_isolation_segment
      select_value: no_isolation_segment
      named_manifests:
      - name: sharding_mode
        manifest: |
          shared-and-segments
      - name: isolation_segments
        manifest: |
          []
      - name: routing_api_enabled
        manifest: true
