---
name: reverse_log_proxy_gateway
release: loggregator
manifest: |

  logging:
    format:
      timestamp: (( .properties.logging_timestamp_format.selected_option.parsed_manifest(rfc3339_or_deprecated) ))
  http:
    address: "0.0.0.0:8088"
    cert: (( .properties.reverse_log_proxy_gateway_server_tls_cert.cert_pem))
    key: (( .properties.reverse_log_proxy_gateway_server_tls_cert.private_key_pem))
  logs_provider:
    ca_cert: (( $ops_manager.ca_certificate ))
    client_cert: (( .properties.reverse_log_proxy_gateway_client_tls_rlp_cert.cert_pem ))
    client_key: (( .properties.reverse_log_proxy_gateway_client_tls_rlp_cert.private_key_pem ))
    enabled: (( .properties.enable_v2_firehose.value ))
  cc:
    capi_internal_addr: https://cloud-controller-ng.service.cf.internal:9023
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.reverse_log_proxy_gateway_client_tls_cc_cert.cert_pem ))
    key: (( .properties.reverse_log_proxy_gateway_client_tls_cc_cert.private_key_pem ))
    common_name: cloud-controller-ng.service.cf.internal
  uaa:
    ca_cert: (( $ops_manager.ca_certificate ))
    internal_addr: https://uaa.service.cf.internal:8443
    client_id: (( .uaa.doppler_client_credentials.identity ))
    client_secret: (( .uaa.doppler_client_credentials.password ))
  metrics:
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.rlp_gateway_metrics_tls.cert_pem ))
    key: (( .properties.rlp_gateway_metrics_tls.private_key_pem ))
    server_name: rlp_gateway_metrics