---
name: loggregator_agent_windows
release: loggregator-agent
consumes: |
  doppler: {from: doppler, deployment: (( ..cf.deployment_name )) }
manifest: |
  metrics:
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.loggregator_agent_metrics_tls.cert_pem ))
    key: (( .properties.loggregator_agent_metrics_tls.private_key_pem ))
    server_name: loggregator_agent_metrics
  loggregator:
    tls:
      ca_cert: (( $ops_manager.ca_certificate ))
      agent:
        cert: (( .properties.loggregator_agent_tls_cert.cert_pem ))
        key: (( .properties.loggregator_agent_tls_cert.private_key_pem ))
    use_v2_api: true
  grpc_port: 3459
  disable_udp: true
  enabled: (( ..cf.properties.enable_v2_firehose.value ))
  tags:
    placement_tag: (( .windows_diego_cell.placement_tags.value ))
    product: $( variable "label" )
    system_domain: "(( ..cf.cloud_controller.system_domain.value ))"
