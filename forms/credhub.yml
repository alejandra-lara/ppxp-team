---
name: credhub
label: CredHub
description: |
  Configure the CredHub Server

verifiers:
- name: Verifiers::MysqlDatabaseVerifier
  properties:
    host: .properties.credhub_database.external.host
    port: .properties.credhub_database.external.port
    username: .properties.credhub_database.external.username
    password: .properties.credhub_database.external.password
    database: .properties.credhub_database_name

property_inputs:
- reference: .properties.credhub_database
  label: |
    Choose the location of your CredHub database
  selector_property_inputs:
  - reference: .properties.credhub_database.internal_mysql
    label: |
      Internal MySQL (preferred for complete high-availability)

  - reference: .properties.credhub_database.external
    label: |
      External (preferred if, for example, you use Google Cloud SQL)
    property_inputs:
      - reference: .properties.credhub_database.external.host
        label: Hostname

      - reference: .properties.credhub_database.external.port
        label: TCP Port

      - reference: .properties.credhub_database.external.username
        label: Username

      - reference: .properties.credhub_database.external.password
        label: Password

      - reference: .properties.credhub_database.external.tls_ca
        label: Database CA Certificate

- reference: .properties.credhub_key_encryption_passwords
  label: Encryption Keys
  property_inputs:
  - reference: name
    label: Name
    description: |
      Name of the encryption key.
  - reference: provider
    label: Provider
  - reference: key
    label: Key
    description: |
      The encryption key will be used to encrypt all data. The key must be
      at least 20 characters long.
  - reference: primary
    label: Primary
    description: |
       Checking this checkbox marks this key as the primary encryption key.
       Only one key should be marked as primary.

- reference: .properties.credhub_hsm_provider_partition
  label: HSM Provider Partition
  description: |
    The name of the HSM provider partition.

- reference: .properties.credhub_hsm_provider_partition_password
  label: HSM Provider Partition Password
  description: |
    The password used to access the HSM provider partition.

- reference: .properties.credhub_hsm_provider_client_certificate
  label: HSM Provider Client Certificate
  description: |
    The client certificate for the HSM.

- reference: .properties.credhub_hsm_provider_servers
  label: HSM Provider Servers
  property_inputs:
  - reference: host_address
    label: Host Address
    description: |
      The host name or IP address of the HSM server.
  - reference: port
    label: Port
    description: |
      The port of the HSM server.
  - reference: partition_serial_number
    label: Partition Serial Number
    description: |
      The serial number of the HSM partition.
  - reference: hsm_certificate
    label: HSM Certificate
    description: |
      The certificate for the HSM server.

- reference: .properties.secure_service_instance_credentials
  label: Secure Service Instance Credentials
  description: |
    When checked, service brokers that support storing their service
    instance credentials in CredHub will do so.
