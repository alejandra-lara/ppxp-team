---
name: garden
release: garden-runc
manifest: |
  garden:
    cleanup_process_dirs_on_wait: true
    debug_listen_address: 127.0.0.1:17019
    deny_networks:
    - 0.0.0.0/0
    deprecated_use_garden_shed: "(( .properties.enable_grootfs.value ? false : true ))"
    destroy_containers_on_start: true
    graph_cleanup_threshold_in_mb: (( .properties.garden_disk_cleanup.selected_option.parsed_manifest(graph_cleanup_threshold_in_mb) ))
    http_proxy: (( $ops_manager.http_proxy ))
    https_proxy: (( $ops_manager.https_proxy ))
    insecure_docker_registry_list: (( .diego_cell.insecure_docker_registry_list.parsed_strings ))
    network_plugin: /var/vcap/packages/runc-cni/bin/garden-external-networker
    network_plugin_extra_args:
    - --configFile=/var/vcap/jobs/garden-cni/config/adapter.json
    no_proxy: (( $ops_manager.no_proxy ))
    persistent_image_list:
    - /var/vcap/packages/cflinuxfs2/rootfs
    privileged_image_plugin: /var/vcap/packages/grootfs/bin/grootfs
    privileged_image_plugin_extra_args:
    - --config
    - /var/vcap/jobs/grootfs/config/privileged_grootfs_config.yml
  grootfs:
    graph_cleanup_threshold_in_mb: (( .properties.garden_disk_cleanup.selected_option.parsed_manifest(graph_cleanup_threshold_in_mb) ))
    insecure_docker_registry_list: (( .diego_cell.insecure_docker_registry_list.parsed_strings ))
    persistent_image_list:
    - /var/vcap/packages/cflinuxfs2/rootfs.tar
    tls:
      ca_cert: (( $ops_manager.ca_certificate ))
      cert: (( .properties.rep_server_cert.cert_pem ))
      key: (( .properties.rep_server_cert.private_key_pem ))
