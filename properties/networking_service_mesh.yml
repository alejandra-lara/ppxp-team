---
- name: istio
  type: selector
  configurable: true
  default: disable
  option_templates:
    - name: disable
      select_value: disable
      named_manifests:
      - name: ads_addresses
        manifest: |
           []
      - name: internal_service_mesh_domains
        manifest: |
          []
    - name: enable
      select_value: enable
      named_manifests:
      - name: ads_addresses
        manifest: |
          ["169.254.0.2:15010"]
      - name: internal_service_mesh_domains
        manifest: |
          (( .properties.cf_networking_internal_domains.parsed_manifest(for_bosh_dns_adapter) ))

- name: istio_domain
  type: string
  configurable: true
  optional: true

- name: istio_frontend_tls_keypairs
  type: collection
  configurable: true
  optional: true
  property_blueprints:
  - name: name
    type: string
    configurable: true
  - name: certificate
    type: rsa_cert_credentials
    configurable: true
  named_manifests:
  - name: istio_certificates_and_private_keys
    manifest: |
      cert_chain: (( current_record.certificate.cert_pem ))
      private_key: (( current_record.certificate.private_key_pem ))
