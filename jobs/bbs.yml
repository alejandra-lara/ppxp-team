---
name: bbs
release: diego
manifest: |
  bpm:
    enabled: true
  database:
    tls:
      enable_identity_verification: (( .properties.system_database.selected_option.parsed_manifest(diego-enable-identity-verification) ))
  diego:
    bbs:
      active_key_label: key1
      auctioneer:
        api_location: auctioneer.service.cf.internal:9016
        ca_cert: (( $ops_manager.ca_certificate ))
        client_cert: (( .properties.auctioneer_client_cert.cert_pem ))
        client_key: (( .properties.auctioneer_client_cert.private_key_pem ))
      ca_cert: (( $ops_manager.ca_certificate ))
      detect_consul_cell_registrations: false
      encryption_keys:
      - label: key1
        passphrase: ((( diego-db-bbs-encryption-passphrase )))
      rep:
        ca_cert: (( $ops_manager.ca_certificate ))
        client_cert: (( .properties.rep_client_cert.cert_pem ))
        client_key: (( .properties.rep_client_cert.private_key_pem ))
      server_cert: (( .properties.bbs_server_cert.cert_pem ))
      server_key: (( .properties.bbs_server_cert.private_key_pem ))
      skip_consul_lock: true
      sql: (( .properties.system_database.selected_option.parsed_manifest(diegodb) ))
  enable_consul_service_registration: false
  logging:
    format:
      timestamp: (( .properties.diego_log_timestamp_format.selected_option.parsed_manifest(timestamp_format) ))
  loggregator:
    use_v2_api: true
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.loggregator_client_cert.cert_pem ))
    key: (( .properties.loggregator_client_cert.private_key_pem ))
