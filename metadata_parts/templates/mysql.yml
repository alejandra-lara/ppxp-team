---
name: mysql
release: cf-mysql
provides: |
  internal-mysql-database: {as: direct-mysql}

manifest: |
  cf_mysql:
    mysql:
      cli_history: (( cli_history.value ))
      interrupt_notify_cmd: "/var/vcap/jobs/send-email/bin/run"
      innodb_buffer_pool_size: 2147483648
      innodb_strict_mode: true
      max_open_files: 1048576
      startup_timeout: 120
      cluster_probe_timeout: (( cluster_probe_timeout.value ))
      cluster_health:
        password: (( cluster_health_user.password ))
      seeded_databases:
      - name: (( .properties.ccdb_database_name.value ))
        username: ((( mysql-cc-db-credentials.username )))
        password: ((( mysql-cc-db-credentials.password )))
      - name: (( .properties.uaa_database_name.value ))
        username: ((( mysql-uaa-db-credentials.username )))
        password: ((( mysql-uaa-db-credentials.password )))
      - name: (( .properties.app_usage_service_database_name.value ))
        username: (( app_usage_credentials.identity ))
        password: (( app_usage_credentials.password ))
      - name: (( .properties.notifications_database_name.value ))
        username: ((( mysql-notifications-credentials.username )))
        password: ((( mysql-notifications-credentials.password )))
      - name: (( .properties.autoscale_database_name.value ))
        username: ((( mysql-autoscale-credentials.username )))
        password: ((( mysql-autoscale-credentials.password )))
      - name: monitor
        username: ((( mysql-monitor-db-credentials.username )))
        password: ((( mysql-monitor-db-credentials.password )))
      - name: (( .properties.diego_database_name.value ))
        username: ((( mysql-diego-db-credentials.username )))
        password: ((( mysql-diego-db-credentials.password )))
      - name: (( .properties.locket_database_name.value ))
        username: ((( mysql-locket-db-credentials.username )))
        password: ((( mysql-locket-db-credentials.password )))
      - name: (( .properties.routing_database_name.value ))
        username: ((( mysql-routing-db-credentials.username )))
        password: ((( mysql-routing-db-credentials.password )))
      - name: (( .properties.silk_database_name.value ))
        username: ((( mysql-silk-db-credentials.username )))
        password: ((( mysql-silk-db-credentials.password )))
      - name: (( .properties.networkpolicyserver_database_name.value ))
        username: ((( mysql-network-policy-server-db-credentials.username )))
        password: ((( mysql-network-policy-server-db-credentials.password )))
      - name: (( .properties.account_database_name.value ))
        username: ((( mysql-pivotal-account-credentials.username )))
        password: ((( mysql-pivotal-account-credentials.password )))
      - name: (( .properties.nfsvolume_database_name.value ))
        username: ((( mysql-nfs-volume-credentials.username )))
        password: ((( mysql-nfs-volume-credentials.password )))
      server_audit_excluded_users:
      - ((( mysql-monitor-db-credentials.username )))
      admin_password: (( mysql_admin_credentials.password ))
      galera_healthcheck:
        db_password: (( galera_sidecar_user.password ))
        endpoint_username: ((( mysql-bootstrap-credentials.username )))
        endpoint_password: ((( mysql-bootstrap-credentials.password )))
      server_audit_events: (( .properties.mysql_activity_logging.selected_option.parsed_manifest(mysql_audit_events) ))
