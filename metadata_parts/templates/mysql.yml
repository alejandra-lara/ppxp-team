---
name: mysql
release: cf-mysql
provides: |
  internal-mysql-database: {as: direct-mysql}

manifest: |
  cf_mysql:
    mysql:
      interrupt_notify_cmd: "/var/vcap/jobs/send-email/bin/run"
      innodb_buffer_pool_size: 2147483648
      innodb_strict_mode: true
      max_open_files: 1048576
      startup_timeout: 120
      cluster_probe_timeout: (( cluster_probe_timeout.value ))
      cluster_health:
        password: (( cluster_health_user.password ))
      seeded_databases:
      - name: (( .properties.ccdb_database_name.value ))
        username: (( ccdb_credentials.identity ))
        password: (( ccdb_credentials.password ))
      - name: (( .properties.uaa_database_name.value ))
        username: (( uaadb_credentials.identity ))
        password: (( uaadb_credentials.password ))
      - name: (( .properties.app_usage_service_database_name.value ))
        username: (( app_usage_credentials.identity ))
        password: (( app_usage_credentials.password ))
      - name: (( .properties.notifications_database_name.value ))
        username: (( notifications_credentials.identity ))
        password: (( notifications_credentials.password ))
      - name: (( .properties.autoscale_database_name.value ))
        username: (( autoscale_credentials.identity ))
        password: (( autoscale_credentials.password ))
      - name: monitor
        username: (( monitordb_credentials.identity ))
        password: (( monitordb_credentials.password ))
      - name: (( .properties.diego_database_name.value ))
        username: (( diegodb_credentials.identity ))
        password: (( diegodb_credentials.password ))
      - name: (( .properties.locket_database_name.value ))
        username: (( locketdb_credentials.identity ))
        password: (( locketdb_credentials.password ))
      - name: (( .properties.routing_database_name.value ))
        username: (( routingdb_credentials.identity ))
        password: (( routingdb_credentials.password ))
      - name: (( .properties.silk_database_name.value ))
        username: (( silkdb_credentials.identity ))
        password: (( silkdb_credentials.password ))
      - name: (( .properties.networkpolicyserver_database_name.value ))
        username: (( networkpolicyserverdb_credentials.identity ))
        password: (( networkpolicyserverdb_credentials.password ))
      - name: (( .properties.account_database_name.value ))
        username: (( pivotal_account_credentials.identity ))
        password: (( pivotal_account_credentials.password ))
      - name: (( .properties.nfsvolume_database_name.value ))
        username: (( nfsvolume_credentials.identity ))
        password: (( nfsvolume_credentials.password ))
      server_audit_excluded_users:
      - (( monitordb_credentials.identity ))
      admin_password: (( mysql_admin_credentials.password ))
      galera_healthcheck:
        db_password: (( galera_sidecar_user.password ))
        endpoint_username: (( mysql_bootstrap_credentials.identity ))
        endpoint_password: (( mysql_bootstrap_credentials.password ))
      server_audit_events: (( .properties.mysql_activity_logging.selected_option.parsed_manifest(mysql_audit_events) ))
